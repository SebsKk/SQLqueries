-- A query joining two tables for warehouse orders and finding warehouses with total order > 500

SELECT
wrh.warehouse_alias AS name,
COUNT(*) AS number_of_orders
FROM 
theta-sunlight-355515.warehouse.wrh AS wrh
JOIN
theta-sunlight-355515.warehouse.orders2 AS orders
ON 
orders.warehouse_id = wrh.warehouse_id
GROUP BY 1
HAVING COUNT(*) > 500
ORDER BY 2 DESC
LIMIT 10
